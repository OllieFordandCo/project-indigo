"use strict";System.register([],function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i,o;return{setters:[],execute:function(){i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),e("App",o=function(){function e(){n(this,e),this._importedElements=[],window.dispatchEvent(new CustomEvent("appReady")),console.log("App is Ready")}return i(e,[{key:"init",value:function(){this.updateElements(),this.initRouter()}},{key:"initRouter",value:function(){Promise.all([System["import"]("director"),System["import"]("router")]).then(function(e){var t=e[0],n=e[1];window.router=t(n.routes).configure(n.routerConfig).init(),console.log("Router Initialised as a window global..."),document.documentElement.className="js",window.App.captureLinks(),window.dispatchEvent(new CustomEvent("systemReady"))},function(e){console.log(e),console.log("The router couldn't be loaded, default navigation."),window.dispatchEvent(new CustomEvent("routerReady"))})}},{key:"initSocial",value:function(){System["import"]("think-async").then(function(e){e.add("instagram","//platform.instagram.com/en_US/embeds.js",function(){window.addEventListener("viewUpdated",function(e){window.instgrm&&instgrm.Embeds.process()})}),e.add("twitter","//platform.twitter.com/widgets.js",function(e){})})}},{key:"lazyLoadElements",value:function(e){e=void 0==e?[].slice.call(document.querySelectorAll("[data-import]")):e;var t=this;e.forEach(function(e){var n=void 0,i=new RegExp(" +","g");if(n=e.hasAttribute("is")?e.getAttribute("is").replace(i,"-").toLowerCase():e.tagName.replace(i,"-").toLowerCase(),t.importedElements.indexOf(n)==-1){var o=document.createElement("link"),r=e.dataset["import"];o.rel="import",""==r?o.href=window.indigo.components_url+n+".html":o.href=window.indigo.components_url+r,document.head.appendChild(o),t.importedElements=n}})}},{key:"findAndLoadElements",value:function(){var e=[].slice.call(document.querySelectorAll("[data-import]"));e.length>0&&(window.App.lazyLoadElements(e),window.App.captureLinks())}},{key:"updateElements",value:function(){var e=[].slice.call(document.querySelectorAll("[data-import]"));e.length>0&&this.lazyLoadElements(e)}},{key:"onClickEventHandler",value:function(e){if(console.log("System is handling link event"),this.href.indexOf(window.esvibe.site_url)>-1){e.preventDefault();var t=this;t.href!==window.location.href&&window.router.setRoute(this.href)}}},{key:"captureLinks",value:function(){var e=document.querySelectorAll("a[href]");for(var t in e)e[t]instanceof Node&&"#"!==e[t].getAttribute("href")&&(e[t].hasAttribute("data-prevent-default")?e[t].addEventListener("click",function(e){e.preventDefault()}):e[t].addEventListener("click",this.onClickEventHandler))}},{key:"importedElements",get:function(){return this._importedElements},set:function(e){this._importedElements.push(e)}}],[{key:"getCustomElementName",value:function(e){return e.replace(/ +/g,"-").toLowerCase()}}]),e}()),e("App",o)}}});