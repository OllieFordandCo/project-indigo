<dom-module id=app-sidebar>
    <style>:host{position:fixed;top:0;left:0;bottom:0;border-radius:0;border-width:0 1px 0 0;box-shadow:none;margin:0;width:10%;max-width:175px;overflow:hidden;padding:30px}:host:after{content:"";position:absolute;top:30px;right:0;bottom:30px;width:0;border-right:1px solid #e1e1e1}:host.right-sidebar{left:auto;right:0}:host.right-sidebar:after{right:auto;left:0}</style>
    <template>
        <a href="{{siteSettings.site_url}}">{{siteSettings.site_name}}</a>
        <content></content>
    </template>
    <script>
        Polymer({
            is: "app-sidebar",
            extends: "nav",
            properties: {
                siteSettings: {
                    type: Object,
                    value: function() {
                       return {};
                    },
                    notify: true
                }
            },
            ready: function () {
                window.App.updateElements(Polymer.dom(this.root));
                if(window.indigo) {
                    this.set('siteSettings', window.indigo);
                }
            },
            attached: function () {
                window.App.captureLinks();
                window.App.animateElement(this);

                var sidebar = this;

                // Toggle when mobile view
                if("matchMedia" in window) {
                    var mql = window.matchMedia("(max-width: 575px)");
                    mql.addListener(function () {
                        if (mql.matches) {
                            var direction = (sidebar.classList.contains('right-sidebar')) ? 'translateX(100%)' : 'translateX(-100%)';
                            delete sidebar.dataset.animate;
                            sidebar.style.willChange = 'transform';
                            sidebar.style.transform = direction;
                            sidebar.style.willChange = 'auto';
                        } else {
                            delete sidebar.dataset.animate;
                            sidebar.style.willChange = 'transform';
                            sidebar.style.transform = 'translateX(0)';
                            sidebar.style.willChange = 'auto';
                        }
                    });
                    console.log(mql);
                }
            }
        });
    </script>
</dom-module>